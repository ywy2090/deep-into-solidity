
# ERC-3643 å®Œæ•´æŠ€æœ¯æŒ‡å—

## ç›®å½•

1. [ç®€å•æ€»ç»“ï¼šç”¨å¤§ç™½è¯è¯´ ERC-3643](#ä¸€ç®€å•æ€»ç»“ç”¨å¤§ç™½è¯è¯´-erc-3643)
2. [å·¥ä½œåŸç†ã€åŠŸèƒ½ä¸åº”ç”¨é¢†åŸŸ](#äºŒå·¥ä½œåŸç†åŠŸèƒ½ä¸åº”ç”¨é¢†åŸŸ)
3. [æ™ºèƒ½åˆçº¦æ¶æ„ä¸ä»£ç å®ç°](#ä¸‰æ™ºèƒ½åˆçº¦æ¶æ„ä¸ä»£ç å®ç°)
4. [å·¥ä½œæµç¨‹è¯¦è§£](#å››å·¥ä½œæµç¨‹è¯¦è§£)
5. [ONCHAINID æ·±åº¦è§£æ](#äº”onchainid-æ·±åº¦è§£æ)
6. [æ€»ç»“ä¸å±•æœ›](#å…­æ€»ç»“ä¸å±•æœ›)

---

## ä¸€ã€ç®€å•æ€»ç»“ï¼šç”¨å¤§ç™½è¯è¯´ ERC-3643

### ğŸ¯ ä¸€å¥è¯æ¦‚æ‹¬

**ERC-3643 = å¸¦èº«ä»½éªŒè¯å’Œåˆè§„é™åˆ¶çš„ä»£å¸æ ‡å‡†**ï¼Œä¸“é—¨ç”¨äºæŠŠç°å®ä¸–ç•Œçš„èµ„äº§ï¼ˆå¦‚è‚¡ç¥¨ã€æˆ¿äº§ã€å€ºåˆ¸ï¼‰æ¬åˆ°åŒºå—é“¾ä¸Šã€‚

---

### æ ¸å¿ƒåŠŸèƒ½

#### ä¸»è¦ç”¨é€”

**æŠŠéœ€è¦ç›‘ç®¡çš„èµ„äº§å˜æˆåŒºå—é“¾ä»£å¸**ï¼Œæ¯”å¦‚ï¼š
- å…¬å¸è‚¡ç¥¨
- æˆ¿åœ°äº§ä»½é¢
- å€ºåˆ¸
- ç§å‹ŸåŸºé‡‘

---

#### ä¸æ™®é€šä»£å¸çš„åŒºåˆ«

| æ™®é€šä»£å¸ï¼ˆå¦‚ USDTï¼‰ | ERC-3643 ä»£å¸ |
|---|---|
| ä»»ä½•äººéƒ½èƒ½ä¹°å– | **å¿…é¡»é€šè¿‡ KYC èº«ä»½éªŒè¯** |
| éšä¾¿è½¬ç»™è°éƒ½è¡Œ | **åªèƒ½è½¬ç»™åˆæ ¼çš„æŠ•èµ„è€…** |
| æ²¡æœ‰æŒæœ‰é™åˆ¶ | **å¯ä»¥è®¾ç½®æŒæœ‰ä¸Šé™** |
| é’±åŒ…ä¸¢äº†ä»£å¸å°±æ²¡äº† | **å¯ä»¥é€šè¿‡èº«ä»½æ‰¾å›ä»£å¸** |

---

### ğŸ›¡ï¸ å››å¤§æ ¸å¿ƒåŠŸèƒ½

#### 1. **èº«ä»½è®¤è¯**ï¼ˆå¿…é¡»è¯æ˜ä½ æ˜¯è°ï¼‰
```
æƒ³ä¹°ä»£å¸ï¼Ÿå…ˆå®Œæˆ KYC éªŒè¯ï¼š
â€¢ ä¸Šä¼ èº«ä»½è¯
â€¢ è¯æ˜ä½å€
â€¢ é€šè¿‡åæ´—é’±æ£€æŸ¥
â†’ é€šè¿‡åè·å¾—"èº«ä»½è¯æ˜"ï¼ˆå­˜åœ¨åŒºå—é“¾ä¸Šï¼‰
```

#### 2. **è½¬è´¦é™åˆ¶**ï¼ˆä¸æ˜¯æƒ³è½¬ç»™è°å°±è½¬ç»™è°ï¼‰
```
è½¬è´¦æ—¶è‡ªåŠ¨æ£€æŸ¥ï¼š
â€¢ å¯¹æ–¹æœ‰æ²¡æœ‰åšè¿‡ KYCï¼Ÿ âŒ æ²¡æœ‰ â†’ æ‹’ç»
â€¢ å¯¹æ–¹æŒæœ‰é‡ä¼šä¸ä¼šè¶…é™ï¼Ÿ âŒ è¶…é™ â†’ æ‹’ç»
â€¢ å¯¹æ–¹æ˜¯ä¸æ˜¯é»‘åå•å›½å®¶ï¼Ÿ âŒ æ˜¯ â†’ æ‹’ç»
âœ… å…¨éƒ¨é€šè¿‡ â†’ å…è®¸è½¬è´¦
```

#### 3. **åˆè§„è§„åˆ™**ï¼ˆè‡ªåŠ¨æ‰§è¡Œç›‘ç®¡è¦æ±‚ï¼‰
```
å‘è¡Œæ–¹å¯ä»¥è®¾ç½®è§„åˆ™ï¼š
â€¢ å•ä¸ªäººæœ€å¤šæŒæœ‰ 10%
â€¢ ç¾å›½æŠ•èµ„è€…ä¸è¶…è¿‡ 100 äºº
â€¢ ä»£å¸é”å®šæœŸ 1 å¹´
â€¢ æœ€å°‘æŒæœ‰ 1000 ä¸ª
â†’ ä»£ç è‡ªåŠ¨æ‰§è¡Œï¼Œæ²¡äººèƒ½è¿å
```

#### 4. **ä»£å¸æ‰¾å›**ï¼ˆä¸¢é’±åŒ…ä¸ç­‰äºä¸¢èµ„äº§ï¼‰
```
ä¼ ç»Ÿæ–¹å¼ï¼šé’±åŒ…ç§é’¥ä¸¢äº† â†’ ä»£å¸æ°¸è¿œæ‰¾ä¸å›
ERC-3643ï¼šç§é’¥ä¸¢äº† â†’ ç”¨èº«ä»½éªŒè¯ â†’ è½¬åˆ°æ–°é’±åŒ…
ï¼ˆå°±åƒé“¶è¡Œå¡ä¸¢äº†å¯ä»¥è¡¥åŠï¼‰
```

---

### ğŸŒŸ è§£å†³çš„æ ¸å¿ƒé—®é¢˜

#### é—®é¢˜ï¼šç°å®èµ„äº§ä¸Šé“¾çš„ä¸‰å¤§éšœç¢

1. **æ³•å¾‹è¦æ±‚**ï¼šè¯åˆ¸äº¤æ˜“å¿…é¡»çŸ¥é“æŠ•èµ„è€…èº«ä»½ï¼ˆåæ´—é’±æ³•ï¼‰
2. **æŠ•èµ„è€…ä¿æŠ¤**ï¼šè¦é™åˆ¶è°èƒ½ä¹°ã€èƒ½ä¹°å¤šå°‘
3. **èµ„äº§å®‰å…¨**ï¼šä¼ ç»ŸåŒºå—é“¾é’±åŒ…ä¸¢äº†å°±æ°¸è¿œæ‰¾ä¸å›

#### è§£å†³æ–¹æ¡ˆï¼šERC-3643 çš„è®¾è®¡

```
æ™®é€š ERC-20 ä»£å¸
    â†“
åŠ ä¸Šã€Œèº«ä»½ç³»ç»Ÿã€ï¼ˆONCHAINIDï¼‰
    â†“  
åŠ ä¸Šã€Œåˆè§„æ£€æŸ¥å™¨ã€ï¼ˆModular Complianceï¼‰
    â†“
= ERC-3643 è¯åˆ¸å‹ä»£å¸
```

---

### ğŸ’¡ å®é™…åº”ç”¨ä¾‹å­

#### åœºæ™¯ 1ï¼šæˆ¿åœ°äº§ä»£å¸åŒ–
```
ä¸€æ ‹ä»·å€¼ 1000ä¸‡ çš„å•†ä¸šæ¥¼
    â†“ åˆ‡åˆ†æˆ 100 ä¸‡ä¸ªä»£å¸
æ¯ä¸ªä»£å¸ = 10 å…ƒ
    â†“ è®¾ç½®è§„åˆ™
â€¢ åªæœ‰é€šè¿‡ KYC çš„æŠ•èµ„è€…èƒ½ä¹°
â€¢ å•äººæœ€å¤šæŒæœ‰ 10%ï¼ˆ10ä¸‡ä¸ªï¼‰
â€¢ ä¸­å›½å±…æ°‘ä¸èƒ½è´­ä¹°ï¼ˆç›‘ç®¡é™åˆ¶ï¼‰
    â†“ å¥½å¤„
â€¢ æ™®é€šäººå¯ä»¥ä¹°å¾—èµ·ï¼ˆ10å…ƒèµ·ï¼‰
â€¢ ç«‹å³äº¤æ˜“ï¼ˆä¸éœ€è¦ç­‰å‡ ä¸ªæœˆè¿‡æˆ·ï¼‰
â€¢ è‡ªåŠ¨åˆ†é…ç§Ÿé‡‘æ”¶ç›Š
```

#### åœºæ™¯ 2ï¼šå…¬å¸è‚¡æƒä»£å¸
```
åˆ›ä¸šå…¬å¸å‘è¡Œè‚¡æƒä»£å¸
    â†“ è®¾ç½®è§„åˆ™
â€¢ å¿…é¡»æ˜¯åˆæ ¼æŠ•èµ„è€…ï¼ˆå¹´æ”¶å…¥ > 20ä¸‡ç¾å…ƒï¼‰
â€¢ å‘˜å·¥ä»£å¸é”å®š 1 å¹´
â€¢ ç¾å›½æŠ•èµ„è€…ä¸è¶…è¿‡ 99 äººï¼ˆSEC è§„å®šï¼‰
    â†“ è‡ªåŠ¨æ‰§è¡Œ
â€¢ å‘˜å·¥ 1 å¹´å†…æƒ³å– â†’ äº¤æ˜“è‡ªåŠ¨å¤±è´¥
â€¢ ç¬¬ 100 ä¸ªç¾å›½äººæƒ³ä¹° â†’ äº¤æ˜“è‡ªåŠ¨æ‹’ç»
```

---

### âœ… ä¼˜åŠ¿æ€»ç»“

| ä¼˜åŠ¿ | è¯´æ˜ |
|---|---|
| **åˆæ³•åˆè§„** | æ»¡è¶³è¯åˆ¸æ³•è¦æ±‚ï¼Œä¸ä¼šè¢«ç›‘ç®¡å…³åœ |
| **è‡ªåŠ¨åŒ–** | è§„åˆ™å†™å…¥ä»£ç ï¼Œä¸éœ€è¦äººå·¥å®¡æ ¸ |
| **é€æ˜** | æ‰€æœ‰è§„åˆ™å…¬å¼€å¯æŸ¥ |
| **é«˜æ•ˆ** | 24/7 äº¤æ˜“ï¼Œç§’çº§ç»“ç®— |
| **ä½æˆæœ¬** | ä¸éœ€è¦ä¸­ä»‹æœºæ„ |
| **å¯è¿½æº¯** | æ‰€æœ‰è½¬è´¦è®°å½•æ°¸ä¹…ä¿å­˜ |

---

### ğŸ“Š å¸‚åœºæ•°æ®

- **å·²ä»£å¸åŒ–èµ„äº§è§„æ¨¡**ï¼š280 äº¿ç¾å…ƒ
- **åº”ç”¨é¢†åŸŸ**ï¼šè¯åˆ¸ã€æˆ¿åœ°äº§ã€å€ºåˆ¸ã€åŸºé‡‘
- **ä¸»è¦ä¼˜åŠ¿**ï¼šåˆæ³•åˆè§„ + è‡ªåŠ¨åŒ–æ‰§è¡Œ

---

## äºŒã€å·¥ä½œåŸç†ã€åŠŸèƒ½ä¸åº”ç”¨é¢†åŸŸ

### 2.1 å·¥ä½œåŸç†

ERC-3643ï¼ˆåŸç§° T-REX Protocolï¼‰æ˜¯ä¸€ä¸ªä¸“ä¸º**å—ç›‘ç®¡è¯åˆ¸å‹ä»£å¸**è®¾è®¡çš„ä»¥å¤ªåŠæ ‡å‡†ï¼Œé‡‡ç”¨"**åˆè§„æ€§è®¾è®¡**"ï¼ˆCompliance by Designï¼‰ç†å¿µã€‚

#### æ ¸å¿ƒå·¥ä½œåŸç†ï¼šåŸºäºå››å¤§æ”¯æŸ±çš„å»ä¸­å¿ƒåŒ–éªŒè¯ç³»ç»Ÿ

1. **ONCHAINID**ï¼šé“¾ä¸Šèº«ä»½ç®¡ç†ç³»ç»Ÿï¼Œä¸ºæ¯ä¸ªå‚ä¸è€…åˆ›å»ºå…¨çƒå¯è®¿é—®çš„åŒºå—é“¾èº«ä»½
2. **éªŒè¯è¯ä¹¦ï¼ˆClaimsï¼‰**ï¼šç”±å—ä¿¡ä»»ç¬¬ä¸‰æ–¹ç­¾å‘å¹¶å­˜å‚¨åœ¨é“¾ä¸Šçš„å¯éªŒè¯å‡­è¯
3. **èµ„æ ¼éªŒè¯ç³»ç»Ÿï¼ˆEVSï¼‰**ï¼šé€šè¿‡ Identity Registry çš„ `isVerified()` å‡½æ•°éªŒè¯æ¥æ”¶æ–¹èº«ä»½èµ„æ ¼
4. **æ¨¡å—åŒ–åˆè§„ç³»ç»Ÿ**ï¼šé€šè¿‡ Modular Compliance çš„ `canTransfer()` å‡½æ•°ç¡®ä¿ç¬¦åˆå‘è¡Œè§„åˆ™

---

### 2.2 ä¸ ERC-20 çš„å…³é”®åŒºåˆ«

#### è½¬è´¦æµç¨‹å¯¹æ¯”

```
ERC-20ï¼š
å‘é€æ–¹ â†’ æ¥æ”¶æ–¹ï¼ˆæ— é™åˆ¶ï¼‰

ERC-3643ï¼š
å‘é€æ–¹ â†’ ä»£å¸åˆçº¦ â†’ éªŒè¯å™¨æ£€æŸ¥ â†’ 
         â”œâ”€ é€šè¿‡ï¼šæ‰§è¡Œè½¬è´¦
         â””â”€ æ‹’ç»ï¼šè¿”å›é”™è¯¯åŸå› 
```

#### æ ¸å¿ƒå·®å¼‚

| ç‰¹æ€§ | ERC-20 | ERC-3643 |
|------|--------|----------|
| è½¬è´¦æƒé™ | æ— è®¸å¯ï¼ˆä»»ä½•äººï¼‰ | è®¸å¯å‹ï¼ˆéœ€éªŒè¯ï¼‰ |
| èº«ä»½è¦æ±‚ | æ—  | å¿…éœ€ ONCHAINID |
| KYC/AML | é“¾ä¸‹å¤„ç† | é“¾ä¸Šè‡ªåŠ¨éªŒè¯ |
| æŒæœ‰é™åˆ¶ | æ—  | å¯é…ç½® |
| ä»£å¸æ¢å¤ | ä¸å¯èƒ½ | æ”¯æŒ |
| åˆè§„è§„åˆ™ | æ—  | æ¨¡å—åŒ–å¯é…ç½® |

---

### 2.3 å…³é”®åŠŸèƒ½ç‰¹æ€§

- **èº«ä»½å…³è”**ï¼šé’±åŒ…åœ°å€ä¸ ONCHAINID ç»‘å®š
- **åˆè§„å¼ºåˆ¶**ï¼šé“¾ä¸Šè‡ªåŠ¨æ‰§è¡Œ KYC/AML è§„åˆ™
- **ä»£å¸æ¢å¤**ï¼šæŠ•èµ„è€…ä¸¢å¤±ç§é’¥æ—¶å¯é€šè¿‡èº«ä»½éªŒè¯æ¢å¤ä»£å¸
- **æ¨¡å—åŒ–è®¾è®¡**ï¼šå¯çµæ´»é…ç½®ä¸åŒçš„åˆè§„è§„åˆ™
- **å®Œå…¨å…¼å®¹ ERC-20**ï¼šå¯æ— ç¼é›†æˆç°æœ‰ ERC-20 åŸºç¡€è®¾æ–½

---

### 2.4 åº”ç”¨é¢†åŸŸ

ERC-3643 ä¸“æ³¨äº**çœŸå®èµ„äº§ä»£å¸åŒ–ï¼ˆRWA Tokenizationï¼‰**é¢†åŸŸï¼š

#### 1. è¯åˆ¸ä»£å¸åŒ–
- å…¬å¸è‚¡æƒ
- å€ºåˆ¸
- ç§å‹ŸåŸºé‡‘ä»½é¢

#### 2. å®ç‰©èµ„äº§ä»£å¸åŒ–
- æˆ¿åœ°äº§
- è´·æ¬¾èµ„äº§
- è‰ºæœ¯å“å’Œæ”¶è—å“

#### 3. å—ç›‘ç®¡é‡‘èå¸‚åœº
- Security Token Offerings (STOs)
- äºŒçº§å¸‚åœºäº¤æ˜“
- DeFi åˆè§„é›†æˆ

---

## ä¸‰ã€æ™ºèƒ½åˆçº¦æ¶æ„ä¸ä»£ç å®ç°

### 3.1 æ•´ä½“æ¶æ„

ERC-3643 é‡‡ç”¨**æ¨¡å—åŒ–æ¶æ„**ï¼Œæ ¸å¿ƒç”±ä»¥ä¸‹æ™ºèƒ½åˆçº¦ç»„æˆï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Token Contract    â”‚
â”‚  (ERC-3643 Token)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚             â”‚
           â–¼             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Identity Registryâ”‚  â”‚ Modular Compliance  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼              â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Identity Reg.  â”‚ â”‚  Trusted    â”‚ â”‚ Claim Topics â”‚
â”‚    Storage     â”‚ â”‚  Issuers    â”‚ â”‚   Registry   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  Registry   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ONCHAINID    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.2 æ ¸å¿ƒåˆçº¦ç»„ä»¶è¯¦è§£

#### 1. Token Contractï¼ˆä»£å¸åˆçº¦ï¼‰

**èŒè´£**ï¼šERC-20 å…¼å®¹çš„è®¸å¯å‹ä»£å¸æ ¸å¿ƒ

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// æ¡ä»¶è½¬è´¦
function transfer(address _to, uint256 _amount) returns (bool) {
    require(_canTransfer(msg.sender, _to, _amount), "Transfer not compliant");
    return super.transfer(_to, _amount);
}

// è½¬è´¦éªŒè¯é€»è¾‘
function _canTransfer(address _from, address _to, uint256 _amount) 
    internal view returns (bool) 
{
    // 1. æ£€æŸ¥èº«ä»½èµ„æ ¼ï¼ˆEVSï¼‰
    if (!identityRegistry.isVerified(_to)) {
        return false;
    }
    
    // 2. æ£€æŸ¥åˆè§„è§„åˆ™
    if (!compliance.canTransfer(_from, _to, _amount)) {
        return false;
    }
    
    return true;
}

// ä»£å¸æ¢å¤åŠŸèƒ½
function recoveryAddress(
    address _lostWallet,
    address _newWallet,
    address _investorOnchainID
) onlyAgent
```

---

#### 2. Identity Registryï¼ˆèº«ä»½æ³¨å†Œè¡¨ï¼‰

**èŒè´£**ï¼šèµ„æ ¼éªŒè¯ç³»ç»Ÿï¼ˆEVSï¼‰æ‰§è¡Œä¸­å¿ƒ

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// éªŒè¯åœ°å€æ˜¯å¦åˆæ ¼
function isVerified(address _userAddress) returns (bool)

// æ³¨å†Œèº«ä»½
function registerIdentity(
    address _user,
    address _identity,
    uint16 _country
)

// åˆ é™¤èº«ä»½
function deleteIdentity(address _user)
```

**éªŒè¯é€»è¾‘**ï¼š
1. ä» Identity Registry Storage è·å–é’±åŒ…å¯¹åº”çš„ ONCHAINID
2. æ£€æŸ¥ ONCHAINID æ˜¯å¦åŒ…å« Claim Topics Registry ä¸­è¦æ±‚çš„æ‰€æœ‰å£°æ˜ä¸»é¢˜
3. éªŒè¯å£°æ˜æ˜¯å¦ç”± Trusted Issuers Registry ä¸­çš„å—ä¿¡ä»»ç­¾å‘è€…ç­¾å‘
4. ç¡®è®¤å£°æ˜æœªè¿‡æœŸ

---

#### 3. Identity Registry Storageï¼ˆèº«ä»½å­˜å‚¨ï¼‰

**èŒè´£**ï¼šèº«ä»½æ˜ å°„å­˜å‚¨åº“

**æ•°æ®ç»“æ„**ï¼š
```solidity
struct Identity {
    address identityContract;  // ONCHAINID åœ°å€
    uint16 investorCountry;    // ISO-3166 å›½å®¶ä»£ç 
}

mapping(address => Identity) private identities;
```

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// å­˜å‚¨èº«ä»½
function addIdentityToStorage(
    address _userAddress,
    address _identity,
    uint16 _country
)

// ä¿®æ”¹å›½å®¶ä»£ç 
function modifyStoredInvestorCountry(
    address _userAddress,
    uint16 _country
)
```

---

#### 4. Trusted Issuers Registryï¼ˆå—ä¿¡ä»»ç­¾å‘è€…æ³¨å†Œè¡¨ï¼‰

**èŒè´£**ï¼šç®¡ç†æˆæƒçš„å£°æ˜ç­¾å‘è€…ï¼ˆKYC æä¾›å•†ã€æ”¿åºœæœºæ„ç­‰ï¼‰

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// æ·»åŠ å—ä¿¡ä»»ç­¾å‘è€…
function addTrustedIssuer(
    address _trustedIssuer,
    uint256[] _claimTopics
)

// ç§»é™¤ç­¾å‘è€…
function removeTrustedIssuer(address _trustedIssuer)

// æ›´æ–°ç­¾å‘è€…æˆæƒçš„å£°æ˜ä¸»é¢˜
function updateIssuerClaimTopics(
    address _trustedIssuer,
    uint256[] _claimTopics
)
```

---

#### 5. Claim Topics Registryï¼ˆå£°æ˜ä¸»é¢˜æ³¨å†Œè¡¨ï¼‰

**èŒè´£**ï¼šå®šä¹‰æŒæœ‰ä»£å¸æ‰€éœ€çš„å£°æ˜ä¸»é¢˜

**ç¤ºä¾‹å£°æ˜ä¸»é¢˜**ï¼š
- Topic 1: KYC éªŒè¯
- Topic 2: åˆæ ¼æŠ•èµ„è€…èµ„æ ¼
- Topic 3: å±…ä½åœ°è¯æ˜
- Topic 4: AML æ£€æŸ¥

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// æ·»åŠ å£°æ˜ä¸»é¢˜
function addClaimTopic(uint256 _claimTopic)

// ç§»é™¤å£°æ˜ä¸»é¢˜
function removeClaimTopic(uint256 _claimTopic)

// è·å–æ‰€æœ‰å¿…éœ€ä¸»é¢˜
function getClaimTopics() returns (uint256[])
```

---

#### 6. Modular Complianceï¼ˆæ¨¡å—åŒ–åˆè§„ï¼‰

**èŒè´£**ï¼šæ¨¡å—åŒ–åˆè§„è§„åˆ™å¼•æ“

**å¸¸è§åˆè§„è§„åˆ™**ï¼š
- æœ€å¤§æŠ•èµ„è€…æ•°é‡é™åˆ¶ï¼ˆæŒ‰å›½å®¶ï¼‰
- å•ä¸ªæŠ•èµ„è€…æŒæœ‰ä¸Šé™
- å›½å®¶ç™½åå•/é»‘åå•
- æ—¶é—´é”å®šæœŸ
- æœ€å°æŒæœ‰é‡‘é¢

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// æ£€æŸ¥è½¬è´¦æ˜¯å¦åˆè§„
function canTransfer(
    address _from,
    address _to,
    uint256 _amount
) returns (bool)

// æ·»åŠ åˆè§„æ¨¡å—
function addModule(address _module)

// è°ƒç”¨åˆè§„æ¨¡å—æ£€æŸ¥
function moduleCheck(
    address _module,
    address _from,
    address _to,
    uint256 _value
) internal returns (bool)
```

**åˆè§„æ¨¡å—ç¤ºä¾‹**ï¼š
```solidity
// æœ€å¤§æŒæœ‰é‡æ¨¡å—
contract MaxBalanceModule {
    mapping(address => uint256) public maxBalances;
    
    function moduleCheck(
        address _from,
        address _to,
        uint256 _value
    ) external returns (bool) {
        uint256 newBalance = token.balanceOf(_to) + _value;
        return newBalance <= maxBalances[_to];
    }
}
```

---

#### 7. ONCHAINIDï¼ˆé“¾ä¸Šèº«ä»½ï¼‰

**èŒè´£**ï¼šåŸºäº ERC-734ï¼ˆå¯†é’¥ç®¡ç†ï¼‰å’Œ ERC-735ï¼ˆå£°æ˜ç®¡ç†ï¼‰çš„é“¾ä¸Šèº«ä»½å®¹å™¨

**å…³é”®åŠŸèƒ½**ï¼š
```solidity
// å¯†é’¥ç®¡ç†
function addKey(bytes32 _key, uint256 _purpose, uint256 _keyType)
function removeKey(bytes32 _key, uint256 _purpose)
function keyHasPurpose(bytes32 _key, uint256 purpose) returns (bool)

// å£°æ˜ç®¡ç†
function addClaim(
    uint256 _topic, 
    uint256 _scheme, 
    address _issuer, 
    bytes _signature, 
    bytes _data, 
    string _uri
) returns (bytes32 claimId)

function getClaim(bytes32 _claimId) returns (Claim)
function getClaimIdsByTopic(uint256 _topic) returns (bytes32[])
```

---

#### 8. Implementation Authorityï¼ˆå®ç°æƒé™ï¼‰

**èŒè´£**ï¼šåŸºäº ERC-1822 é€šç”¨å¯å‡çº§ä»£ç†æ ‡å‡†ï¼ˆUUPSï¼‰çš„ç‰ˆæœ¬ç®¡ç†

**ä¼˜åŠ¿**ï¼š
- å¯ä¸€æ¬¡æ€§å‡çº§æ‰€æœ‰ä½¿ç”¨ç›¸åŒ Implementation Authority çš„ä»£å¸
- å‘è¡Œæ–¹å¯ç‹¬ç«‹ç®¡ç†ç‰ˆæœ¬æ§åˆ¶
- æ”¯æŒä»£ç†åˆ‡æ¢åˆ°ä¸åŒçš„ç¬¬ä¸‰æ–¹ç®¡ç†

---

#### 9. Factory Contractï¼ˆå·¥å‚åˆçº¦ï¼‰

**èŒè´£**ï¼šè‡ªåŠ¨åŒ–éƒ¨ç½²å®Œæ•´çš„ ERC-3643 ä»£å¸å¥—ä»¶

**éƒ¨ç½²æµç¨‹**ï¼š
```solidity
function deployToken(
    string memory _name,
    string memory _symbol,
    uint8 _decimals,
    address _identityRegistryStorage,
    address _compliance
) returns (address tokenAddress)
```

---

### 3.3 åˆçº¦å…³ç³»å›¾

```
æ•°æ®æµå‘ï¼ˆè½¬è´¦éªŒè¯æµç¨‹ï¼‰ï¼š

User initiates transfer
    â†“
Token Contract
    â†“
Identity Registry.isVerified(receiver)
    â”œâ†’ Identity Registry Storage (get ONCHAINID)
    â”œâ†’ ONCHAINID (get claims)
    â”œâ†’ Trusted Issuers Registry (verify issuer)
    â””â†’ Claim Topics Registry (check required topics)
    â†“
Modular Compliance.canTransfer()
    â””â†’ Execute compliance modules
    â†“
Execute transfer or revert with reason
```

---

## å››ã€å·¥ä½œæµç¨‹è¯¦è§£

### 4.1 å®Œæ•´è½¬è´¦éªŒè¯æµç¨‹

```
é˜¶æ®µ 1ï¼šèº«ä»½èµ„æ ¼éªŒè¯ï¼ˆEVSï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. å‘é€æ–¹å‘èµ· transfer(receiver, amount)
2. Token åˆçº¦è°ƒç”¨ _canTransfer()
3. è°ƒç”¨ Identity Registry.isVerified(receiver)
4. Identity Registry ä» Storage è·å– receiver çš„ ONCHAINID åœ°å€
5. å¦‚æœæœªæ³¨å†Œ â†’ æ‹’ç»äº¤æ˜“ï¼š"æ¥æ”¶æ–¹æœªæ³¨å†Œ"
6. è·å– Claim Topics Registry ä¸­çš„å¿…éœ€å£°æ˜ä¸»é¢˜åˆ—è¡¨
7. éå†æ¯ä¸ªå¿…éœ€ä¸»é¢˜ï¼š
   a. ä» ONCHAINID è·å–è¯¥ä¸»é¢˜çš„å£°æ˜
   b. å¦‚æœæ— å£°æ˜ â†’ æ‹’ç»äº¤æ˜“ï¼š"ç¼ºå°‘å¿…éœ€å£°æ˜"
   c. æå–å£°æ˜çš„ç­¾å‘è€…åœ°å€
   d. æ£€æŸ¥ç­¾å‘è€…æ˜¯å¦åœ¨ Trusted Issuers Registry ä¸­
   e. å¦‚æœä¸å¯ä¿¡ â†’ æ‹’ç»äº¤æ˜“ï¼š"å£°æ˜ç­¾å‘è€…æ— æ•ˆ"
   f. éªŒè¯å£°æ˜ç­¾åæœ‰æ•ˆæ€§
   g. æ£€æŸ¥å£°æ˜æ˜¯å¦è¿‡æœŸ
   h. å¦‚æœè¿‡æœŸ â†’ æ‹’ç»äº¤æ˜“ï¼š"å£°æ˜å·²è¿‡æœŸ"
8. æ‰€æœ‰å£°æ˜éªŒè¯é€šè¿‡ âœ“


é˜¶æ®µ 2ï¼šåˆè§„è§„åˆ™æ£€æŸ¥
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
9. è°ƒç”¨ Modular Compliance.canTransfer(sender, receiver, amount)
10. è·å–æ‰€æœ‰ç»‘å®šçš„åˆè§„æ¨¡å—
11. éå†æ¯ä¸ªåˆè§„æ¨¡å—ï¼š
    a. è°ƒç”¨æ¨¡å—çš„ moduleCheck()
    
    ç¤ºä¾‹ï¼šæœ€å¤§æŒæœ‰é‡æ£€æŸ¥
    - è·å– receiver å½“å‰ä½™é¢
    - è®¡ç®—è½¬è´¦åä½™é¢
    - æ£€æŸ¥æ˜¯å¦è¶…è¿‡æŒæœ‰ä¸Šé™
    - å¦‚æœè¶…è¿‡ â†’ æ‹’ç»äº¤æ˜“ï¼š"è¶…è¿‡æŒæœ‰ä¸Šé™"
    
    ç¤ºä¾‹ï¼šå›½å®¶æŠ•èµ„è€…æ•°é‡æ£€æŸ¥
    - è·å– receiver çš„å›½å®¶ä»£ç 
    - æ£€æŸ¥è¯¥å›½æŠ•èµ„è€…æ•°é‡
    - å¦‚æœè¶…è¿‡ä¸Šé™ â†’ æ‹’ç»äº¤æ˜“ï¼š"è¯¥å›½æŠ•èµ„è€…å·²æ»¡"
    
12. æ‰€æœ‰åˆè§„æ¨¡å—æ£€æŸ¥é€šè¿‡ âœ“


é˜¶æ®µ 3ï¼šæ‰§è¡Œè½¬è´¦
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
13. è°ƒç”¨ _transfer(sender, receiver, amount)
14. æ›´æ–°ä½™é¢æ˜ å°„ï¼š
    - balances[sender] -= amount
    - balances[receiver] += amount
15. è°ƒç”¨ compliance.transferred() æ›´æ–°åˆè§„çŠ¶æ€
16. å‘å‡º Transfer äº‹ä»¶
17. äº¤æ˜“æˆåŠŸå®Œæˆ ğŸ‰
```

---

### 4.2 æŠ•èµ„è€…æ³¨å†Œæµç¨‹

```
æ­¥éª¤ 1ï¼šåˆ›å»ºèº«ä»½
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ•èµ„è€…åˆ›å»ºé’±åŒ…åœ°å€
    â†“
æ£€æŸ¥æ˜¯å¦å·²æœ‰ ONCHAINID
    â”œâ”€ å¦ â†’ éƒ¨ç½²æ–°çš„ ONCHAINID åˆçº¦
    â””â”€ æ˜¯ â†’ ä½¿ç”¨ç°æœ‰ ONCHAINID


æ­¥éª¤ 2ï¼šKYC éªŒè¯
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ•èµ„è€…è¯·æ±‚ KYC éªŒè¯
    â†“
KYC æä¾›å•†æ‰§è¡Œå°½èŒè°ƒæŸ¥ï¼š
    â€¢ èº«ä»½éªŒè¯
    â€¢ åœ°å€è¯æ˜
    â€¢ èµ„é‡‘æ¥æºæ£€æŸ¥
    â€¢ åˆ¶è£åå•æ£€æŸ¥
    â†“
å®¡æ ¸é€šè¿‡ï¼Ÿ
    â”œâ”€ å¦ â†’ æ‹’ç»æ³¨å†Œ
    â””â”€ æ˜¯ â†’ ç»§ç»­


æ­¥éª¤ 3ï¼šæ·»åŠ å£°æ˜
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
KYC æä¾›å•†å‡†å¤‡å£°æ˜æ•°æ®ï¼š
    Claim {
        topic: 1 (KYC verified),
        scheme: 1 (ECDSA),
        issuer: KYC Provider ONCHAINID,
        signature: sign(userOID + topic + dataHash),
        data: hash(verificationData),
        uri: "ipfs://..."
    }
    â†“
KYC æä¾›å•†ç”¨ç§é’¥ç­¾åå£°æ˜
    â†“
æŠ•èµ„è€…ï¼ˆæˆ– KYC æä¾›å•†ï¼‰è°ƒç”¨ ONCHAINID.addClaim()
    â†“
å£°æ˜å­˜å‚¨åˆ° ONCHAINID


æ­¥éª¤ 4ï¼šæ³¨å†Œåˆ°ä»£å¸
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å‘è¡Œæ–¹ä»£ç†æ£€æŸ¥æŠ•èµ„è€…èµ„æ ¼
    â†“
æ‰€æœ‰å¿…éœ€å£°æ˜éƒ½å­˜åœ¨ï¼Ÿ
    â”œâ”€ å¦ â†’ ç­‰å¾…è¡¥å……å…¶ä»–å£°æ˜
    â””â”€ æ˜¯ â†’ ç»§ç»­
    â†“
å‘è¡Œæ–¹ä»£ç†è°ƒç”¨ï¼š
identityRegistry.registerIdentity(
    é’±åŒ…åœ°å€,
    ONCHAINIDåœ°å€,
    å›½å®¶ä»£ç 
)
    â†“
èº«ä»½ä¿¡æ¯å­˜å‚¨åˆ° Identity Registry Storage
    â†“
å‘å‡º IdentityRegistered äº‹ä»¶
    â†“
âœ… æŠ•èµ„è€…ç°åœ¨å¯ä»¥æ¥æ”¶ä»£å¸
```

---

### 4.3 ä»£å¸éƒ¨ç½²æµç¨‹

```
æ–¹å¼ 1ï¼šä½¿ç”¨å·¥å‚åˆçº¦ï¼ˆæ¨èï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
å‡†å¤‡ä»£å¸å‚æ•°
    â†“
è°ƒç”¨ Factory.deployToken(
    name,
    symbol,
    decimals,
    identityRegistryStorage,
    compliance
)
    â†“
å·¥å‚åˆçº¦è‡ªåŠ¨éƒ¨ç½²ï¼š
    1. ClaimTopicsRegistry
    2. TrustedIssuersRegistry
    3. IdentityRegistryStorage
    4. IdentityRegistry
    5. ModularCompliance
    6. Token åˆçº¦
    7. è®¾ç½®æ‰€æœ‰åˆçº¦å…³è”å…³ç³»
    8. é…ç½®ä»£ç†å’Œå®ç°æƒé™
    â†“
éƒ¨ç½²å®Œæˆ


æ–¹å¼ 2ï¼šæ‰‹åŠ¨éƒ¨ç½²
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. éƒ¨ç½² ClaimTopicsRegistry
   - æ·»åŠ å¿…éœ€çš„å£°æ˜ä¸»é¢˜
   
2. éƒ¨ç½² TrustedIssuersRegistry
   - æ·»åŠ å—ä¿¡ä»»çš„ KYC æä¾›å•†
   
3. éƒ¨ç½² IdentityRegistryStorage
   - å¯é€‰ï¼šå…±äº«ç°æœ‰çš„ Storage
   
4. éƒ¨ç½² IdentityRegistry
   - å…³è” Storageã€Topicsã€Issuers
   
5. éƒ¨ç½² ModularCompliance
   - æ·»åŠ åˆè§„æ¨¡å—
   
6. éƒ¨ç½² Token åˆçº¦
   - å…³è” IdentityRegistry å’Œ Compliance
   
7. é…ç½®ä»£ç†åˆçº¦ï¼ˆå¯é€‰ï¼‰
   - ä½¿ç”¨ ERC-1822 UUPS


åç»­é…ç½®
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
é…ç½®ä»£å¸ ONCHAINID
    â†“
æ·»åŠ èµ„äº§ç›¸å…³å£°æ˜ï¼š
    â€¢ å‘è¡Œæ¡æ¬¾
    â€¢ ç›‘ç®¡ä¿¡æ¯
    â€¢ å…¬å¸è¡Œä¸ºè®°å½•
    â†“
è®¾ç½®æƒé™è§’è‰²ï¼š
    â€¢ Ownerï¼ˆæ‰€æœ‰è€…ï¼‰
    â€¢ Agentï¼ˆä»£ç†ï¼‰
    â€¢ Compliance Manager
    â†“
æ˜¯å¦ç«‹å³é“¸é€ ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ è°ƒç”¨ token.mint()
    â””â”€ å¦ â†’ ä¿ç•™é“¸é€ æƒé™
    â†“
é…ç½®è½¬è´¦é™åˆ¶ï¼š
    â€¢ é”å®šæœŸ
    â€¢ æœ€å°æŒæœ‰é‡
    â€¢ æœ€å¤§æŠ•èµ„è€…æ•°
    â†“
æ‰§è¡ŒåŠŸèƒ½æµ‹è¯•
    â†“
æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Ÿ
    â”œâ”€ å¦ â†’ ä¿®å¤é—®é¢˜å¹¶é‡æ–°æµ‹è¯•
    â””â”€ æ˜¯ â†’ å…¬å¼€å®£å¸ƒä»£å¸éƒ¨ç½²
    â†“
ğŸ‰ ä»£å¸æ­£å¼ä¸Šçº¿
```

---

### 4.4 å£°æ˜æ·»åŠ ä¸éªŒè¯æµç¨‹

```
é˜¶æ®µ 1ï¼šå£°æ˜è¯·æ±‚ä¸ç­¾å‘
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ•èµ„è€… â†’ KYC æä¾›å•†ï¼šæäº¤ KYC ç”³è¯· + ä¸ªäººæ–‡ä»¶
    â†“
KYC æä¾›å•†æ‰§è¡Œå°½èŒè°ƒæŸ¥ï¼š
    â€¢ èº«ä»½éªŒè¯
    â€¢ åœ°å€è¯æ˜
    â€¢ èµ„é‡‘æ¥æº
    â€¢ åˆ¶è£åå•æ£€æŸ¥
    â†“
å®¡æ ¸å¤±è´¥ï¼Ÿâ†’ âŒ æ‹’ç»ç”³è¯·ï¼ˆæµç¨‹ç»ˆæ­¢ï¼‰
    â†“
å®¡æ ¸é€šè¿‡ â†’ å‡†å¤‡å£°æ˜æ•°æ®ï¼š
    claimData = {
        topic: 1 (KYCå·²éªŒè¯),
        scheme: 1,
        issuer: KYC ONCHAINID,
        data: hash(éªŒè¯æ•°æ®),
        uri: "ipfs://..."
    }
    â†“
ä½¿ç”¨ç§é’¥ç­¾åå£°æ˜ï¼š
    signature = sign(investorOID + topic + data)
    â†“
è¿”å›ç­¾åçš„å£°æ˜ç»™æŠ•èµ„è€…


é˜¶æ®µ 2ï¼šå£°æ˜å­˜å‚¨
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŠ•èµ„è€…å‡†å¤‡æ·»åŠ å£°æ˜åˆ° ONCHAINID
    â†“
è°ƒç”¨ ONCHAINID.addClaim(
    topic,
    scheme,
    issuer (KYC ONCHAINID),
    signature,
    data,
    uri
)
    â†“
ç”Ÿæˆå£°æ˜ IDï¼š
    claimId = keccak256(issuer + topic)
    â†“
å­˜å‚¨å£°æ˜åˆ°åˆçº¦ï¼š
    claims[claimId] = Claim
    â†“
æ›´æ–°ä¸»é¢˜ç´¢å¼•ï¼š
    claimsByTopic[topic].push(claimId)
    â†“
å‘å‡º ClaimAdded äº‹ä»¶
    â†“
âœ… å£°æ˜æ·»åŠ æˆåŠŸ


é˜¶æ®µ 3ï¼šå£°æ˜éªŒè¯ï¼ˆè½¬è´¦æ—¶ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æŸäººå°è¯•å‘æŠ•èµ„è€…è½¬è´¦
    â†“
Token â†’ Identity Registry: isVerified(investor)
    â†“
è·å–å¿…éœ€çš„å£°æ˜ä¸»é¢˜åˆ—è¡¨ï¼š[1, 2, 3]
    â†“
éå†æ¯ä¸ªå¿…éœ€ä¸»é¢˜ï¼š
    â”œâ”€ ä» ONCHAINID è·å–è¯¥ä¸»é¢˜çš„å£°æ˜ ID
    â”œâ”€ æå–å£°æ˜è¯¦æƒ…
    â”œâ”€ æ£€æŸ¥ç­¾å‘è€…æ˜¯å¦å¯ä¿¡
    â”‚   â””â”€ ä¸å¯ä¿¡ï¼Ÿâ†’ âŒ æ‹’ç»è½¬è´¦ï¼š"ç­¾å‘è€…ä¸å¯ä¿¡"
    â”œâ”€ æ£€æŸ¥ç­¾å‘è€…æ˜¯å¦æˆæƒè¯¥ä¸»é¢˜
    â”‚   â””â”€ æœªæˆæƒï¼Ÿâ†’ âŒ æ‹’ç»è½¬è´¦ï¼š"ç­¾å‘è€…æœªæˆæƒè¯¥ä¸»é¢˜"
    â”œâ”€ éªŒè¯ç­¾åæœ‰æ•ˆæ€§
    â”‚   â””â”€ ç­¾åæ— æ•ˆï¼Ÿâ†’ âŒ æ‹’ç»è½¬è´¦ï¼š"å£°æ˜ç­¾åæ— æ•ˆ"
    â””â”€ æ£€æŸ¥å£°æ˜æ˜¯å¦è¿‡æœŸ
        â””â”€ å·²è¿‡æœŸï¼Ÿâ†’ âŒ æ‹’ç»è½¬è´¦ï¼š"å£°æ˜å·²è¿‡æœŸ"
    â†“
âœ… æ‰€æœ‰å£°æ˜éªŒè¯é€šè¿‡
    â†“
ç»§ç»­æ‰§è¡Œåˆè§„æ£€æŸ¥...


é˜¶æ®µ 4ï¼šå£°æ˜æ›´æ–°ä¸æ’¤é”€
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ—¶é—´æµé€ï¼Œå£°æ˜å³å°†è¿‡æœŸ
    â†“
KYC æä¾›å•†å®šæœŸå®¡æŸ¥æŠ•èµ„è€…çŠ¶æ€
    â†“
æŠ•èµ„è€…ä»ç¬¦åˆèµ„æ ¼ï¼Ÿ
    â”œâ”€ æ˜¯ â†’ ç­¾å‘æ–°å£°æ˜ï¼ˆå»¶é•¿æœ‰æ•ˆæœŸï¼‰
    â”‚       â†“
    â”‚   æŠ•èµ„è€…è°ƒç”¨ ONCHAINID.addClaim()
    â”‚       â†“
    â”‚   è¦†ç›–æ—§å£°æ˜ï¼ˆç›¸åŒ topic + issuerï¼‰
    â”‚
    â””â”€ å¦ â†’ KYC æä¾›å•†æ ‡è®°å£°æ˜ä¸ºå·²æ’¤é”€
            â†“
        ä¸‹æ¬¡è½¬è´¦æ—¶éªŒè¯å°†å¤±è´¥
```

---

## äº”ã€ONCHAINID æ·±åº¦è§£æ

### 5.1 æ ¸å¿ƒæ¦‚å¿µ

#### ä»€ä¹ˆæ˜¯ ONCHAINIDï¼Ÿ

**ONCHAINID** æ˜¯ä¸€ä¸ªåŸºäº **ERC-734**ï¼ˆå¯†é’¥ç®¡ç†ï¼‰å’Œ **ERC-735**ï¼ˆå£°æ˜ç®¡ç†ï¼‰æ ‡å‡†çš„**å»ä¸­å¿ƒåŒ–è‡ªä¸»èº«ä»½ï¼ˆSelf-Sovereign Identity, SSIï¼‰ç³»ç»Ÿ**ã€‚

#### å®šä¹‰ç‰¹å¾

- **è‡ªä¸»èº«ä»½**ï¼šç”±èº«ä»½æ‰€æœ‰è€…å®Œå…¨æ§åˆ¶ï¼Œæ— éœ€ä¾èµ–ä¸­å¿ƒåŒ–æœºæ„
- **é“¾ä¸Šå­˜å‚¨**ï¼šèº«ä»½å­˜å‚¨åœ¨ Polygon ç½‘ç»œï¼ˆå¯éƒ¨ç½²åˆ°ä»»ä½• EVM å…¼å®¹é“¾ï¼‰
- **ä¸å¯åˆ é™¤**ï¼šä¸€æ—¦éƒ¨ç½²ï¼Œä»»ä½•ç»„ç»‡æˆ–æœåŠ¡éƒ½æ— æ³•åˆ é™¤æˆ–æ’¤é”€è®¿é—®æƒé™
- **ç»ˆèº«æœ‰æ•ˆ**ï¼šèº«ä»½è·¨è¶Šæ•´ä¸ªç”Ÿå‘½å‘¨æœŸ
- **ä¿¡æ¯èšåˆå™¨**ï¼šå¯èšåˆæ¥è‡ªå¤šä¸ªå¯ä¿¡ç¬¬ä¸‰æ–¹çš„è®¤è¯ä¿¡æ¯
- **åˆè§„åŒ–åŒ¿åæ€§**ï¼šå®ç° "Compliant Pseudonymity"ï¼Œåœ¨ä¿æŠ¤éšç§çš„åŒæ—¶æ»¡è¶³ç›‘ç®¡è¦æ±‚

---

### 5.2 ä¸‰å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           åº”ç”¨å±‚ï¼ˆApplication Layerï¼‰                â”‚
â”‚  â€¢ ç”¨æˆ·ç•Œé¢   â€¢ DApp é›†æˆ   â€¢ API/SDK                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ™ºèƒ½åˆçº¦å±‚ï¼ˆSmart Contract Layerï¼‰           â”‚
â”‚  â€¢ ERC-734 Key Management                           â”‚
â”‚  â€¢ ERC-735 Claim Holder                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ•°æ®å±‚ï¼ˆData Layerï¼‰                         â”‚
â”‚  â€¢ é“¾ä¸Šï¼šå£°æ˜ç­¾åã€å…¬é’¥ã€å…ƒæ•°æ®                        â”‚
â”‚  â€¢ é“¾ä¸‹ï¼šæ•æ„Ÿæ•°æ®ï¼ˆIPFS/ç§æœ‰æœåŠ¡å™¨ï¼‰                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 5.3 ERC-734ï¼šå¯†é’¥ç®¡ç†æ ‡å‡†

#### æ ¸å¿ƒæ¦‚å¿µ

ERC-734 å®šä¹‰äº†ä¸€ä¸ªå¯†é’¥ç®¡ç†å™¨åˆçº¦ï¼Œå…è®¸èº«ä»½æŒæœ‰è€…ç®¡ç†ç”¨äºä¸åŒç›®çš„çš„å¤šä¸ªå¯†é’¥ã€‚

#### å¯†é’¥ç”¨é€”ï¼ˆKey Purposesï¼‰

- **Purpose 1: MANAGEMENT** - ç®¡ç†å¯†é’¥ï¼Œå¯ä»¥æ·»åŠ /åˆ é™¤å…¶ä»–å¯†é’¥
- **Purpose 2: EXECUTION** - æ‰§è¡Œå¯†é’¥ï¼Œå¯ä»¥æ‰§è¡Œäº¤æ˜“ã€ç­¾ç½²æ–‡æ¡£ã€ç™»å½•ç­‰
- **Purpose 3+**: å¯è‡ªå®šä¹‰å…¶ä»–ç”¨é€”

#### å¯†é’¥ç±»å‹ï¼ˆKey Typesï¼‰

- **Type 1: ECDSA** - ä»¥å¤ªåŠæ ‡å‡†æ¤­åœ†æ›²çº¿ç­¾å
- **Type 2: RSA** - RSA åŠ å¯†å¯†é’¥
- **Type 3+**: å…¶ä»–åŠ å¯†ç®—æ³•

#### æ•°æ®ç»“æ„

```solidity
struct Key {
    uint256[] purposes;    // å¯†é’¥ç”¨é€”æ•°ç»„
    uint256 keyType;       // å¯†é’¥ç±»å‹
    bytes32 key;          // å…¬é’¥ï¼ˆé•¿å¯†é’¥å­˜å‚¨å…¶å“ˆå¸Œï¼‰
}

mapping(bytes32 => Key) keys;
mapping(uint256 => bytes32[]) keysByPurpose;
```

#### æ ¸å¿ƒå‡½æ•°

```solidity
// æŸ¥è¯¢å‡½æ•°
function getKey(bytes32 _key) returns (uint256[] purposes, uint256 keyType, bytes32 key)
function keyHasPurpose(bytes32 _key, uint256 purpose) returns (bool exists)
function getKeysByPurpose(uint256 _purpose) returns (bytes32[] keys)

// ç®¡ç†å‡½æ•°
function addKey(bytes32 _key, uint256 _purpose, uint256 _keyType) returns (bool success)
function removeKey(bytes32 _key, uint256 _purpose) returns (bool success)

// æ‰§è¡Œå‡½æ•°
function execute(address _to, uint256 _value, bytes _data) returns (uint256 executionId)
function approve(uint256 _id, bool _approve) returns (bool success)
```

#### å…¸å‹ä½¿ç”¨åœºæ™¯

**åœºæ™¯ï¼šå¤šå¯†é’¥ç®¡ç†**
```
ç”¨æˆ·éƒ¨ç½² ONCHAINID
    â†“
æ·»åŠ ç®¡ç†å¯†é’¥ï¼ˆæ‰‹æœºã€ç¡¬ä»¶é’±åŒ…ã€æ¢å¤å¯†é’¥ï¼‰
    â†“
æ·»åŠ æ‰§è¡Œå¯†é’¥ï¼ˆæ—¥å¸¸äº¤æ˜“é’±åŒ…ï¼‰
    â†“
è®¾ç½®å¤šç­¾è¦æ±‚ï¼š2/3 ç®¡ç†å¯†é’¥æ‰¹å‡†æ‰èƒ½ä¿®æ”¹èº«ä»½
```

**åœºæ™¯ï¼šå¯†é’¥æ¢å¤**
```
ç”¨æˆ·ä¸¢å¤±ä¸»å¯†é’¥
    â†“
ä½¿ç”¨æ¢å¤å¯†é’¥ï¼ˆ2/3 å¤šç­¾ï¼‰
    â†“
è°ƒç”¨ removeKey() ç§»é™¤ä¸¢å¤±çš„å¯†é’¥
    â†“
è°ƒç”¨ addKey() æ·»åŠ æ–°å¯†é’¥
    â†“
èº«ä»½æ§åˆ¶æƒæ¢å¤
```

---

### 5.4 ERC-735ï¼šå£°æ˜ç®¡ç†æ ‡å‡†

#### æ ¸å¿ƒæ¦‚å¿µ

ERC-735 å®šä¹‰äº†å£°æ˜æŒæœ‰è€…æ¥å£ï¼Œå…è®¸ DApps å’Œæ™ºèƒ½åˆçº¦éªŒè¯ç¬¬ä¸‰æ–¹å¯¹èº«ä»½æŒæœ‰è€…çš„å£°æ˜ã€‚

#### å£°æ˜çš„æœ¬è´¨

- **å®šä¹‰**ï¼šç­¾å‘è€…å¯¹èº«ä»½æŒæœ‰è€…çš„**å¯éªŒè¯é™ˆè¿°**
- **ä¿¡ä»»è½¬ç§»**ï¼šä¿¡ä»»ä»èº«ä»½è½¬ç§»åˆ°å£°æ˜çš„ç­¾å‘è€…
- **ç±»å‹**ï¼šè‡ªæˆ‘å£°æ˜ æˆ– ç¬¬ä¸‰æ–¹ç­¾å‘

#### æ•°æ®ç»“æ„

```solidity
struct Claim {
    uint256 topic;        // å£°æ˜ä¸»é¢˜ï¼ˆKYCã€å±…ä½åœ°ã€å­¦å†ç­‰ï¼‰
    uint256 scheme;       // éªŒè¯æ–¹æ¡ˆï¼ˆå¦‚ä½•éªŒè¯æ­¤å£°æ˜ï¼‰
    address issuer;       // ç­¾å‘è€…åœ°å€
    bytes signature;      // ç­¾å
    bytes data;          // å£°æ˜æ•°æ®å“ˆå¸Œæˆ–å®é™…æ•°æ®
    string uri;          // æ•°æ®ä½ç½®ï¼ˆIPFSã€HTTPç­‰ï¼‰
}
```

#### å­—æ®µè¯¦è§£

**1. topicï¼ˆä¸»é¢˜ï¼‰**
æ ‡å‡†ä¸»é¢˜ç¼–å·ï¼š
- `1`: ç”Ÿç‰©ç‰¹å¾æ•°æ®
- `2`: æ°¸ä¹…åœ°å€è¯æ˜
- `3`: KYC éªŒè¯
- `4`: åˆæ ¼æŠ•èµ„è€…èµ„æ ¼
- `5`: AML æ£€æŸ¥
- `100+`: è‡ªå®šä¹‰ä¸»é¢˜

**2. schemeï¼ˆéªŒè¯æ–¹æ¡ˆï¼‰**
- `1`: ECDSA ç­¾åéªŒè¯
- `2`: RSA ç­¾åéªŒè¯
- `3`: æ™ºèƒ½åˆçº¦éªŒè¯
- å…¶ä»–ï¼šè‡ªå®šä¹‰éªŒè¯é€»è¾‘

**3. issuerï¼ˆç­¾å‘è€…ï¼‰**
- å¤–éƒ¨è´¦æˆ·ï¼ˆEOAï¼‰ï¼šç›´æ¥éªŒè¯ç­¾å
- èº«ä»½åˆçº¦ï¼ˆONCHAINIDï¼‰ï¼šæ£€æŸ¥ç­¾åå¯†é’¥æ˜¯å¦åœ¨åˆçº¦ä¸­
- éªŒè¯åˆçº¦ï¼šè°ƒç”¨åˆçº¦çš„éªŒè¯å‡½æ•°

**4. signatureï¼ˆç­¾åï¼‰**
ç­¾åæ¶ˆæ¯ç»“æ„ï¼š
```solidity
bytes32 message = keccak256(
    abi.encodePacked(
        identityHolderAddress,
        topic,
        data
    )
);
signature = sign(message, issuerPrivateKey);
```

**5. dataï¼ˆæ•°æ®ï¼‰**
- å£°æ˜æ•°æ®çš„å“ˆå¸Œï¼ˆä¿æŠ¤éšç§ï¼‰
- å®é™…å£°æ˜æ•°æ®
- æ™ºèƒ½åˆçº¦è°ƒç”¨æ•°æ®
- ä½æ©ç æ ‡å¿—

**6. uriï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰**
- `ipfs://Qm...` - IPFS å“ˆå¸Œ
- `https://kyc.provider.com/claims/123` - HTTP é“¾æ¥
- ç©ºå­—ç¬¦ä¸² - æ‰€æœ‰æ•°æ®åœ¨é“¾ä¸Š

#### æ ¸å¿ƒå‡½æ•°

```solidity
// æŸ¥è¯¢å‡½æ•°
function getClaim(bytes32 _claimId) returns (
    uint256 topic,
    uint256 scheme,
    address issuer,
    bytes signature,
    bytes data,
    string uri
)

function getClaimIdsByTopic(uint256 _topic) returns (bytes32[] claimIds)

// ç®¡ç†å‡½æ•°
function addClaim(
    uint256 _topic,
    uint256 _scheme,
    address _issuer,
    bytes _signature,
    bytes _data,
    string _uri
) returns (uint256 claimRequestId)

function removeClaim(bytes32 _claimId) returns (bool success)
```

**å£°æ˜ ID ç”Ÿæˆè§„åˆ™**ï¼š
```solidity
bytes32 claimId = keccak256(abi.encodePacked(issuer, topic));
```
> æ³¨æ„ï¼šåŒä¸€ç­¾å‘è€…å¯¹åŒä¸€ä¸»é¢˜åªèƒ½æœ‰ä¸€ä¸ªå£°æ˜ï¼ˆè‡ªåŠ¨è¦†ç›–ï¼‰

#### å£°æ˜éªŒè¯æµç¨‹

```
1. è·å–å£°æ˜
   â†“
2. æå–ç­¾å‘è€…åœ°å€
   â†“
3. é‡æ„ç­¾åæ¶ˆæ¯ï¼šmessage = keccak256(identityAddress + topic + data)
   â†“
4. æ¢å¤ç­¾åè€…ï¼šsigner = ecrecover(message, signature)
   â†“
5. éªŒè¯ç­¾å‘è€…ï¼š
   if (issuer is EOA):
       check signer == issuer
   else if (issuer is Identity Contract):
       check issuer.keyHasPurpose(signer, EXECUTION)
   â†“
6. æ£€æŸ¥å£°æ˜æœ‰æ•ˆæœŸï¼ˆå¦‚æœæ•°æ®åŒ…å«è¿‡æœŸæ—¶é—´ï¼‰
   â†“
7. éªŒè¯é€šè¿‡ âœ“
```

---

### 5.5 ONCHAINID åœ¨ ERC-3643 ä¸­çš„åº”ç”¨

#### ä¸‰ç§èº«ä»½è§’è‰²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. æŠ•èµ„è€… ONCHAINID                               â”‚
â”‚     â€¢ å­˜å‚¨ KYC/AML å£°æ˜                            â”‚
â”‚     â€¢ é“¾æ¥é’±åŒ…åœ°å€                                  â”‚
â”‚     â€¢ ç®¡ç†ä¸ªäººä¿¡æ¯è®¿é—®æƒé™                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ä»£å¸ ONCHAINID                                 â”‚
â”‚     â€¢ å­˜å‚¨å‘è¡Œæ¡æ¬¾                                  â”‚
â”‚     â€¢ è®°å½•å…¬å¸è¡Œä¸ºï¼ˆåˆ†çº¢ã€æ‹†è‚¡ç­‰ï¼‰                    â”‚
â”‚     â€¢ ä¿å­˜ç›‘ç®¡æ–‡æ¡£å“ˆå¸Œ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. KYC æä¾›å•† ONCHAINID                           â”‚
â”‚     â€¢ è¯æ˜å…¶åˆæ³•èº«ä»½                                â”‚
â”‚     â€¢ å­˜å‚¨è®¤è¯èµ„è´¨                                  â”‚
â”‚     â€¢ è®°å½•å®¡è®¡å†å²                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Identity Registry å¦‚ä½•ä½¿ç”¨ ONCHAINID

```solidity
function isVerified(address _userAddress) public view returns (bool) {
    // 1. ä» Storage è·å–ç”¨æˆ·çš„ ONCHAINID åœ°å€
    address userOID = identityStorage.storedIdentity(_userAddress);
    if (userOID == address(0)) return false;
    
    // 2. è·å–å¿…éœ€çš„å£°æ˜ä¸»é¢˜åˆ—è¡¨
    uint256[] memory topics = topicsRegistry.getClaimTopics();
    
    // 3. éå†æ¯ä¸ªä¸»é¢˜
    for (uint i = 0; i < topics.length; i++) {
        uint256 topic = topics[i];
        
        // 4. ä» ONCHAINID è·å–è¯¥ä¸»é¢˜çš„å£°æ˜
        IIdentity identity = IIdentity(userOID);
        bytes32[] memory claimIds = identity.getClaimIdsByTopic(topic);
        
        if (claimIds.length == 0) return false;
        
        // 5. éªŒè¯è‡³å°‘æœ‰ä¸€ä¸ªæœ‰æ•ˆå£°æ˜
        bool foundValid = false;
        for (uint j = 0; j < claimIds.length; j++) {
            // è·å–å£°æ˜è¯¦æƒ…
            // æ£€æŸ¥ç­¾å‘è€…æ˜¯å¦å¯ä¿¡
            // æ£€æŸ¥ç­¾å‘è€…æ˜¯å¦æˆæƒç­¾å‘è¯¥ä¸»é¢˜
            // éªŒè¯ç­¾å
            // æ£€æŸ¥å£°æ˜æ˜¯å¦è¿‡æœŸ
            // ... è¯¦ç»†éªŒè¯é€»è¾‘ ...
            
            foundValid = true;
            break;
        }
        
        if (!foundValid) return false;
    }
    
    return true;
}
```

---

### 5.6 éšç§ä¿æŠ¤æœºåˆ¶

#### æ•°æ®åˆ†å±‚å­˜å‚¨

ONCHAINID é‡‡ç”¨**æ··åˆå­˜å‚¨æ¨¡å¼**ï¼š

```
é“¾ä¸Šå­˜å‚¨ï¼ˆå…¬å¼€ï¼‰              é“¾ä¸‹å­˜å‚¨ï¼ˆç§å¯†ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ å£°æ˜ç­¾å                   â€¢ æŠ¤ç…§æ‰«æä»¶
â€¢ å£°æ˜ä¸»é¢˜                   â€¢ é“¶è¡Œè´¦å•
â€¢ ç­¾å‘è€…åœ°å€                 â€¢ èº«ä»½è¯ç…§ç‰‡
â€¢ æ•°æ®å“ˆå¸Œ                   â€¢ ç”Ÿç‰©ç‰¹å¾æ•°æ®
â€¢ å…ƒæ•°æ® URI                 â€¢ è¯¦ç»† KYC æŠ¥å‘Š
```

#### è®¿é—®æ§åˆ¶

```
é»˜è®¤çŠ¶æ€ï¼šæ‰€æœ‰äººå¯è§å£°æ˜å­˜åœ¨ï¼Œä½†æ— æ³•è®¿é—®è¯¦ç»†æ•°æ®
    â†“
DApp è¯·æ±‚è®¿é—®
    â†“
æŠ•èµ„è€…æˆæƒï¼ˆé“¾ä¸‹ç­¾åï¼‰
    â†“
DApp ä½¿ç”¨æˆæƒä»¤ç‰Œè®¿é—® KYC æä¾›å•† API
    â†“
KYC æä¾›å•†éªŒè¯æˆæƒç­¾å
    â†“
è¿”å›è§£å¯†æ•°æ®
```

#### é€‰æ‹©æ€§æŠ«éœ²

æŠ•èµ„è€…å¯ä»¥é€‰æ‹©ï¼š
- å‘ä»£å¸ A æŠ«éœ² KYC å£°æ˜
- å‘ä»£å¸ B æŠ«éœ²å±…ä½åœ°å£°æ˜
- å‘ DeFi åè®® C æŠ«éœ²èµ„äº§è¯æ˜å£°æ˜
- ä¸åŒå®ä½“çœ‹åˆ°ä¸åŒçš„ä¿¡æ¯å­é›†

---

### 5.7 ä¸ä¼ ç»Ÿ KYC çš„å¯¹æ¯”

| ç»´åº¦ | ä¼ ç»Ÿ KYC | ONCHAINID |
|------|---------|-----------|
| **èº«ä»½æ‰€æœ‰æƒ** | å¹³å°æ‹¥æœ‰ | ç”¨æˆ·æ‹¥æœ‰ |
| **æ•°æ®å­˜å‚¨** | ä¸­å¿ƒåŒ–æ•°æ®åº“ | å»ä¸­å¿ƒåŒ– + é“¾ä¸Šç­¾å |
| **é‡å¤éªŒè¯** | æ¯ä¸ªå¹³å°é‡æ–° KYC | ä¸€æ¬¡éªŒè¯ï¼Œå¤šå¤„å¤ç”¨ |
| **éšç§ä¿æŠ¤** | å¹³å°å®Œå…¨è®¿é—® | é€‰æ‹©æ€§æŠ«éœ² |
| **å¯ç§»æ¤æ€§** | æ— æ³•è½¬ç§» | è·¨å¹³å°é€šç”¨ |
| **å®¡è®¡é€æ˜åº¦** | ä¸é€æ˜ | é“¾ä¸Šå¯å®¡è®¡ |
| **å¯†é’¥æ¢å¤** | å¹³å°é‡ç½®å¯†ç  | å¤šç­¾æ¢å¤æœºåˆ¶ |
| **åˆè§„æ€§** | ä¾èµ–å¹³å° | è‡ªåŠ¨åŒ–éªŒè¯ |

---

### 5.8 æŠ€æœ¯ä¼˜åŠ¿ä¸å±€é™æ€§

#### ä¼˜åŠ¿

1. **çœŸæ­£çš„è‡ªä¸»æƒ**ï¼šç”¨æˆ·å®Œå…¨æ§åˆ¶èº«ä»½ï¼Œæ— æ³•è¢«å‰¥å¤º
2. **å¯ç»„åˆæ€§**ï¼šä¸ ERC-3643ã€DeFi åè®®æ— ç¼é›†æˆ
3. **æ•ˆç‡æå‡**ï¼šæ¶ˆé™¤é‡å¤ KYC æµç¨‹
4. **éšç§ä¼˜å…ˆ**ï¼šæ•æ„Ÿæ•°æ®ä¸ä¸Šé“¾ï¼Œä»…å­˜å‚¨è¯æ˜
5. **æŠ—å®¡æŸ¥**ï¼šå»ä¸­å¿ƒåŒ–å­˜å‚¨ï¼Œæ— å•ç‚¹æ•…éšœ
6. **äº’æ“ä½œæ€§**ï¼šåŸºäºå¼€æ”¾æ ‡å‡†ï¼ˆERC-734/735ï¼‰

#### å±€é™æ€§

1. **Gas æˆæœ¬**ï¼šéƒ¨ç½²èº«ä»½åˆçº¦å’Œæ·»åŠ å£°æ˜éœ€è¦æ”¯ä»˜ Gas
2. **ç”¨æˆ·ä½“éªŒ**ï¼šéœ€è¦æ•™è‚²ç”¨æˆ·ç†è§£å¯†é’¥ç®¡ç†
3. **æ ‡å‡†åŒ–ä¸è¶³**ï¼šå£°æ˜ä¸»é¢˜ç¼–å·ç¼ºä¹ç»Ÿä¸€è§„èŒƒ
4. **é“¾å¤–ä¾èµ–**ï¼šä»ä¾èµ–é“¾ä¸‹ KYC æä¾›å•†æœåŠ¡
5. **æ’¤é”€æœºåˆ¶**ï¼šå·²æ·»åŠ çš„å£°æ˜åªèƒ½é€šè¿‡è¿‡æœŸæˆ–ç§»é™¤ï¼Œæ— æ³•è¿½æº¯æ’¤é”€

---

## å…­ã€æ€»ç»“ä¸å±•æœ›

### 6.1 æ ¸å¿ƒä»·å€¼

ERC-3643 é€šè¿‡åˆ›æ–°çš„æ¶æ„è®¾è®¡ï¼ŒæˆåŠŸè§£å†³äº†**å—ç›‘ç®¡èµ„äº§ä»£å¸åŒ–çš„åˆè§„æ€§éš¾é¢˜**ï¼š

```
é—®é¢˜                    è§£å†³æ–¹æ¡ˆ
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ç›‘ç®¡è¦æ±‚ KYC/AML    â†’  ONCHAINID + Claims
æŠ•èµ„è€…èµ„æ ¼é™åˆ¶      â†’  Identity Registry
å‘è¡Œè§„åˆ™é™åˆ¶        â†’  Modular Compliance
é’±åŒ…ä¸¢å¤±æ— æ³•æ‰¾å›    â†’  Recovery Function
é‡å¤éªŒè¯æµªè´¹æ—¶é—´    â†’  ä¸€æ¬¡éªŒè¯ï¼Œå¤šå¤„å¤ç”¨
```

---

### 6.2 æŠ€æœ¯åˆ›æ–°ç‚¹

1. **è®¸å¯å‹ä»£å¸**ï¼šé¦–ä¸ªå°† ERC-20 è½¬æ¢ä¸ºè®¸å¯å‹è½¬è´¦çš„æ ‡å‡†
2. **å»ä¸­å¿ƒåŒ–éªŒè¯**ï¼šæ— éœ€ä¸­å¿ƒåŒ–æœºæ„å³å¯æ‰§è¡Œåˆè§„æ£€æŸ¥
3. **æ¨¡å—åŒ–è®¾è®¡**ï¼šå¯æ’æ‹”çš„åˆè§„è§„åˆ™ï¼Œé€‚åº”ä¸åŒç›‘ç®¡ç¯å¢ƒ
4. **èº«ä»½å¤ç”¨**ï¼šONCHAINID å¯è·¨å¤šä¸ªä»£å¸å’Œ DApp ä½¿ç”¨
5. **éšç§ä¿æŠ¤**ï¼šé“¾ä¸ŠéªŒè¯ + é“¾ä¸‹å­˜å‚¨çš„æ··åˆæ¨¡å¼

---

### 6.3 å¸‚åœºå½±å“

- **ä»£å¸åŒ–èµ„äº§è§„æ¨¡**ï¼š280 äº¿ç¾å…ƒï¼ˆæˆªè‡³ç›®å‰ï¼‰
- **åº”ç”¨é¢†åŸŸ**ï¼šè¯åˆ¸ã€æˆ¿åœ°äº§ã€å€ºåˆ¸ã€ç§å‹ŸåŸºé‡‘
- **ç›‘ç®¡è®¤å¯**ï¼šç¬¦åˆä¸»è¦å¸æ³•ç®¡è¾–åŒºçš„è¯åˆ¸æ³•è¦æ±‚
- **ç”Ÿæ€æ‰©å±•**ï¼šComplyDeFi å°†åˆè§„æ€§å¼•å…¥ DeFi åè®®

---

### 6.4 æœªæ¥å‘å±•æ–¹å‘

#### 1. ä¸ DID æ ‡å‡†æ•´åˆ
æ•´åˆ W3C Decentralized Identifiers (DIDs) æ ‡å‡†ï¼š
```
did:onchainid:polygon:0xABC...
```

#### 2. é›¶çŸ¥è¯†è¯æ˜é›†æˆ
ä½¿ç”¨ zk-SNARKs å®ç°ï¼š
- è¯æ˜"æˆ‘å·²æ»¡ 18 å²"è€Œä¸é€éœ²ç¡®åˆ‡å¹´é¾„
- è¯æ˜"æˆ‘çš„èµ„äº§è¶…è¿‡ 100 ä¸‡"è€Œä¸é€éœ²å…·ä½“é‡‘é¢

#### 3. è·¨é“¾èº«ä»½
é€šè¿‡è·¨é“¾æ¡¥å®ç°ï¼š
```
Polygon ONCHAINID â†â†’ Ethereum â†â†’ Arbitrum â†â†’ Avalanche
```

#### 4. å¯æ’¤é”€å‡­è¯
å¼•å…¥é“¾ä¸Šæ’¤é”€æ³¨å†Œè¡¨ï¼š
```solidity
mapping(bytes32 => bool) public revokedClaims;
```

---

### 6.5 å¼€å‘è€…èµ„æº

#### å®˜æ–¹æ–‡æ¡£
- **ERC-3643 å®˜æ–¹ç½‘ç«™**: https://erc3643.org/
- **ONCHAINID æ–‡æ¡£**: https://docs.onchainid.com/
- **GitHub ä»“åº“**: https://github.com/TokenySolutions/T-REX
- **ERC-734 æ ‡å‡†**: https://github.com/ethereum/EIPs/issues/734
- **ERC-735 æ ‡å‡†**: https://github.com/ethereum/EIPs/issues/735

#### NPM åŒ…
```bash
npm install @onchain-id/solidity
npm install @tokeny/t-rex
```

#### å¿«é€Ÿå¼€å§‹
```solidity
import "@onchain-id/solidity/contracts/Identity.sol";
import "@tokeny/t-rex/contracts/token/Token.sol";

// éƒ¨ç½²ç”¨æˆ·èº«ä»½
Identity userIdentity = new Identity(userManagementKey, false);

// æ·»åŠ å£°æ˜
userIdentity.addClaim(
    1,                  // topic: KYC
    1,                  // scheme: ECDSA
    kycProviderAddress,
    signature,
    data,
    "ipfs://..."
);
```

---

### 6.6 æœ€ç»ˆæ€»ç»“

ERC-3643 æ˜¯**çœŸå®ä¸–ç•Œèµ„äº§ï¼ˆRWAï¼‰ä»£å¸åŒ–çš„åŸºçŸ³æ ‡å‡†**ï¼Œé€šè¿‡ä»¥ä¸‹åˆ›æ–°å®ç°äº†åˆè§„æ€§ä¸å»ä¸­å¿ƒåŒ–çš„å¹³è¡¡ï¼š

âœ… **è‡ªä¸»èº«ä»½æ§åˆ¶**ï¼šç”¨æˆ·æ‹¥æœ‰èº«ä»½è€Œéå¹³å°  
âœ… **éšç§ä¿æŠ¤**ï¼šé“¾ä¸ŠéªŒè¯ + é“¾ä¸‹å­˜å‚¨  
âœ… **äº’æ“ä½œæ€§**ï¼šè·¨å¹³å°å¤ç”¨èº«ä»½å’Œè®¤è¯  
âœ… **åˆè§„æ€§**ï¼šæ»¡è¶³ KYC/AML ç›‘ç®¡è¦æ±‚  
âœ… **çµæ´»æ€§**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œå¯æ‰©å±•åˆè§„è§„åˆ™  
âœ… **å®‰å…¨æ€§**ï¼šä»£å¸æ¢å¤æœºåˆ¶ä¿æŠ¤æŠ•èµ„è€…èµ„äº§  

ä½œä¸ºå”¯ä¸€é’ˆå¯¹å—ç›‘ç®¡è¯åˆ¸ä»£å¸çš„å®Œæ•´æŠ€æœ¯æ ‡å‡†ï¼Œ**ERC-3643 æ­£åœ¨æˆä¸ºå…¨çƒèµ„äº§ä»£å¸åŒ–çš„è¡Œä¸šæ ‡å‡†**ï¼Œä¸ºä¼ ç»Ÿé‡‘èå‘é“¾ä¸Šè¿ç§»é“ºå¹³äº†é“è·¯ã€‚

---

## é™„å½•ï¼šæœ¯è¯­è¡¨

| æœ¯è¯­ | è‹±æ–‡ | è§£é‡Š |
|------|------|------|
| è¯åˆ¸å‹ä»£å¸ | Security Token | ä»£è¡¨çœŸå®èµ„äº§æ‰€æœ‰æƒçš„åŒºå—é“¾ä»£å¸ |
| KYC | Know Your Customer | å®¢æˆ·èº«ä»½éªŒè¯ |
| AML | Anti-Money Laundering | åæ´—é’± |
| RWA | Real World Assets | çœŸå®ä¸–ç•Œèµ„äº§ |
| SSI | Self-Sovereign Identity | è‡ªä¸»èº«ä»½ |
| EVS | Eligibility Verification System | èµ„æ ¼éªŒè¯ç³»ç»Ÿ |
| ONCHAINID | - | åŸºäº ERC-734/735 çš„é“¾ä¸Šèº«ä»½ç³»ç»Ÿ |
| Claim | å£°æ˜ | ç”±ç¬¬ä¸‰æ–¹ç­¾å‘çš„å¯éªŒè¯é™ˆè¿° |
| Issuer | ç­¾å‘è€… | ç­¾å‘å£°æ˜çš„å¯ä¿¡å®ä½“ |
| Compliance Module | åˆè§„æ¨¡å— | å¯æ’æ‹”çš„åˆè§„è§„åˆ™å®ç° |
| Proxy Pattern | ä»£ç†æ¨¡å¼ | å…è®¸æ™ºèƒ½åˆçº¦å‡çº§çš„è®¾è®¡æ¨¡å¼ |
| UUPS | Universal Upgradeable Proxy Standard | é€šç”¨å¯å‡çº§ä»£ç†æ ‡å‡†ï¼ˆERC-1822ï¼‰ |

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0  
**æœ€åæ›´æ–°**ï¼š2025-12-13  
**ä½œè€…**ï¼šAI Assistant  
**è®¸å¯è¯**ï¼šMIT

---

_å¦‚æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ GitHub Issues æå‡ºã€‚_
